(this["webpackJsonpweb-sockjs-client"]=this["webpackJsonpweb-sockjs-client"]||[]).push([[0],{10:function(e,t,n){e.exports=n(17)},15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(7),r=n.n(o),s=(n(15),n(2)),i=n.n(s),l=n(5),u=n(9),m=n(4),h=n(8),d="user"+Math.round(9999*Math.random()),p=new h.Client({brokerURL:"wss://thawing-retreat-89546.herokuapp.com/spring-ws",connectHeaders:{username:d},debug:function(e){return console.log(e)},reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3,onDisconnect:function(e){console.log(e),console.log("On Disconnect")},logRawCommunication:!0});function f(e){var t=new Date,n=Object(a.useState)("".concat(t.getDate()<10?"0"+t.getDate():t.getDate(),"-").concat(t.getMonth()<10?"0"+t.getMonth():t.getMonth(),"-").concat(t.getFullYear())),o=Object(m.a)(n,1)[0],r=Object(a.useState)(""),s=Object(m.a)(r,2),h=s[0],f=s[1];var b=Object(a.useState)([{type:"WELCOME",sender:"system",content:"".concat(d," has entered the room."),class:"none",time:o}]),g=Object(m.a)(b,2),w=g[0],v=g[1],E=Object(a.useCallback)((function(e){e.sender===d?e.class="outgoing":e.class="incoming",v((function(t){return[].concat(Object(u.a)(t),[e])}))}),[]),O=Object(a.useCallback)(Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){p.activate(),e(!0)}));case 2:return t=e.sent,e.next=5,new Promise((function(e){p.configure({onConnect:function(e){p.publish({destination:"/app/chat.newUser",headers:{},body:JSON.stringify({sender:d,type:"CONNECT"})})}}),e()}));case 5:t&&p.configure({onConnect:function(){console.log("On Connect"),p.subscribe("/topic/public",(function(e){if(e){var t=JSON.parse(e.body);E(t)}}))}});case 6:case"end":return e.stop()}}),e)}))),[E]),y=function(){var e=Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={type:"CHAT",sender:d,content:h,time:o},n=JSON.stringify(t),e.next=4,new Promise((function(e){p.publish({destination:"/app/chat.send",header:{},body:n}),e()}));case 4:f("");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=Object(a.useRef)(null);return Object(a.useEffect)((function(){O(),w.length>3&&j.current.scrollIntoView({behavior:"smooth"})}),[O,w]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"chat-box"},c.a.createElement("header",null,c.a.createElement("h1",null,"Simple Chat App")),c.a.createElement("div",{className:"chat-body"},c.a.createElement("div",{className:"chat-thread"},w.map((function(e,t){return c.a.createElement("p",{key:t,className:e.class},c.a.createElement("span",null,e.sender===d?"Myself":e.sender," "),e.content,c.a.createElement("span",null,c.a.createElement("i",null," ",e.time)))})),c.a.createElement("div",{ref:j})),c.a.createElement("div",{className:"chat-message"},c.a.createElement("textarea",{type:"text",onChange:function(e){f(e.target.value)},maxLength:100,rows:3,value:h}),c.a.createElement("div",{className:"chat-button"},c.a.createElement("button",{onClick:y},"Send"))))))}var b=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(f,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[10,1,2]]]);
//# sourceMappingURL=main.5814bf52.chunk.js.map